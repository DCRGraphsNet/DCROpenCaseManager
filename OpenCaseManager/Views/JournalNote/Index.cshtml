<script language="javascript" type="text/javascript">
    function windowClose() {
        window.close();
    }
</script>


@{
    /// <summary>
    /// Return the content of a journalnote.rtf
    /// </summary>
    /// <param name="instanceId"></param>
    /// <param name="documentLink"></param>
    /// <param name="documentTitle"></param>
    /// <param name="documentAuthor"></param>
    /// <returns> </returns>
    var errorMessage = "";
    Array Data = null;

    var instanceId = Request.QueryString["instanceId"];
    var documentLink = Request.QueryString["documentLink"];
    var documentTitle = Request.QueryString["documentTitle"];
    var documentAuthor = Request.QueryString["documentAuthor"];
    var document = Request.QueryString["documentTitle"];
    var dataFile = Server.MapPath($"~/App_Data/JournalNotes/{instanceId}/{documentLink}.html");

    if (File.Exists(dataFile))
    {
        Data = File.ReadAllLines(dataFile);
        if (Data == null) // If the file is empty
        {
            // Empty file.
            errorMessage = "The file is empty.";
        }
    }
    else
    {
        // File does not exist.
        errorMessage = "The file does not exist. This might be due to it being recently changed.";
    }
}
<style>
    .author {
        margin-bottom: 20px;
    }

    .pre-scrollable {
        max-height: 55vh;
        margin-bottom: 20px;
    }
</style>

<link type="text/css" rel="stylesheet" href="~/Content/journalnote.css" />


<div class="container">

    @errorMessage
    @if (errorMessage == "")
    {
        <h1 class="title"> @documentTitle</h1>
        <h2 class="author"> @documentAuthor</h2>
        <div class="pre-scrollable">
            <div class="content">
                @foreach (string dataLine in Data)
                {
                    <div class="documentContent">
                        @Html.Raw(@dataLine)
                    </div>
                }
            </div>
        </div>
    }
    <div class="journalNotatButtons">
        <a href="javascript:windowClose();"> Luk jounal notat</a>
        <button class="open-journal-note-button" onclick="CreateJournalNoteViewWithLink();">Rediger</button>
    </div>
    <input type="hidden" id="documentLink">
</div>

<script type="text/javascript">
    $(document).ready(function () {
        var documentLink = App.getParameterByName("documentLink", window.location.href);
        //if ($("div").empty()) {
        //    $(this).remove();
        //}
        $(".content").find("div").each(function () {
            if ($.trim($(this).text()) == ""){
                $(this).remove();
            }
        });
        $('head title', window.parent.document).text(documentTitle);
        $('#documentLink').val(documentLink);
        
        //console.log($('#documentLink').val(''));
    });
</script>