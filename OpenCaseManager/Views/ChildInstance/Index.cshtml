@{
    ViewBag.Title = "Instance"; //This will be overwritten when the page is fully loaded
}


<div class="wholeActionsPage">
    <div class="tabsBox col-lg-10 col-md-10 col-sm-12 col-xs-12">
        <nav aria-label="breadcrumb" class="breadcrumbsNavigation">
            <ol class="breadcrumb arr-right bg-dark ">
                <li class="breadcrumb-item  "><a href="~/MyChildren/"><span data-locale data-apply="text" data-key="MyChildren"></span></a></li>
                <li class="breadcrumb-item "><a href="" id="childLink"></a></li>
                <li class="breadcrumb-item active instance" aria-current="page"></li>
            </ol>
        </nav>
        <table class="table table-responsive entityDetailTable" style="width:100%">
            <tr>
                <th class="caseTitle"><span style="text-decoration:underline;color: #9C1A5E;cursor:pointer" id="instanceTitle"></span></th>
                <td><span style="float:right;display:none;" class="caseLink"><a target="_blank" id="entityLink" href="#"><img width="12px" src="../content/images/standard/caseLink.png"></a></span><span style="float:right;display:none;padding-right:10px;" class="caseNum"><span id="instanceCaseNo"></span></span></td>
            </tr>
        </table>
        <div>
            <div class="chageResFormating responsibleSelectOptions" id="itemResponsible"> <span class="responsibleImgSpan"><img src="~/Content/Images/standard/exchange.png" class="responsibleImg" /></span> <strong id="instanceResponsible" class="linkStyling"></strong></div>

            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                <li class="nav-item active">
                    <a class="nav-link" id="pills-activitiesb" data-toggle="tab" href="#pills-activities" role="tab" aria-controls="pills-activities" aria-selected="false"><span data-locale data-apply="text" data-key="Instance"></span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-document-tab" data-toggle="tab" href="#pills-document" role="tab" aria-controls="pills-document" aria-selected="false"><span data-locale data-apply="text" data-key="Documents"></span></a>
                </li>
            </ul>
            <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade in active" id="pills-activities" role="tabpanel" aria-labelledby="pills-activities">
                    @Html.Partial("~/Views/PartialViews/Tasks.cshtml")
                    @Html.Partial("~/Views/PartialViews/AdditionalTasks.cshtml")
                </div>
                <div class="tab-pane fade in" id="pills-document" role="tabpanel" aria-labelledby="pills-document">
                    @Html.Partial("~/Views/PartialViews/Document.cshtml")
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
        @Html.Partial("~/Views/PartialViews/AddButton.cshtml", new ViewDataDictionary { { "add-text", "AddDocument" }, { "onClick", "addDocument()" } })
        @Html.Partial("~/Views/PartialViews/AddButton.cshtml", new ViewDataDictionary { { "add-text", "AddJournalNote" }, { "onClick", "CreateJournalNoteView()" } })
        @Html.Partial("~/Views/PartialViews/UpdateInstanceTitle.cshtml")
        <div class="stamdataBox">
            @Html.Partial("~/Views/PartialViews/ObsBox.cshtml")
            @Html.Partial("~/Views/PartialViews/Stamdata.cshtml")
        </div>
    </div>
</div><!-- Row Div End -->

<div class="addDocumentModalCI">
    @Html.Partial("~/Views/PartialViews/AddDocumentModal.cshtml")
</div>

<script src="~/Scripts/child-instance.js"></script>
<script src="~/Scripts/breadcrumbs.js"></script>


<script type="text/javascript">
    var webPortalType = "Instance";
    var instanceId = getParameterByName("id", window.location.href);

    function DoHeader(i) {
        var tabTitle = $('#instanceTitle').text();
        var childName = $('#childName').text();
        if (childName != null && childName.length > 0) tabTitle = childName + ' - ' + tabTitle;
        if (tabTitle.length != 0) {
            if (i != null)
                clearInterval(i);
            // safe to execute your code here
            $('head title', window.parent.document).text(tabTitle);
        }
    }
    function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        url = url.toLowerCase();
        name = name.toLowerCase();
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }
    // Checks if InstanceTitle has been set every 100 milliseconds, and sets the title of the tab to the InstanceTitle when it is set.
    $(window).ready(function () {
        $('.addDocumentModal').html('');
        var i = setInterval(function () {
            DoHeader(i);
        }, 500);
    });
</script>

<script src="~/Scripts/task.js"></script>
<script src="~/Scripts/journalNoteCreate.js" type="text/javascript"></script>
<script src="~/Scripts/addDocument.js" type="text/javascript"></script>

@Html.Partial("~/Views/PartialViews/DCRForm.cshtml")
@Html.Partial("~/Views/PartialViews/AddTask.cshtml")
@Html.Partial("~/Views/PartialViews/TasksWithNote.cshtml")
@Html.Partial("~/Views/PartialViews/DesignerIframe.cshtml")